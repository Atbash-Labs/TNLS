
<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/"/>

    <title>Getting started &#8212; Atbash documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css"/>
    <link rel="stylesheet" type="text/css" href="../../../../../_static/alabaster.css"/>
    <script data-url_root="../../../../../" id="documentation_options"
            src="../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../_static/jquery.js"></script>
    <script src="../../../../../_static/underscore.js"></script>
    <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html"/>
    <link rel="search" title="Search" href="../../../../../search.html"/>

    <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css"/>


    <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9"/>

</head>
<body>


<div class="document">
    <div class="documentwrapper">
        <div class="bodywrapper">


            <div class="body" role="main">

                <section id="getting-started">
                    <h1>Getting started<a class="headerlink" href="#getting-started"
                                          title="Permalink to this heading">¶</a></h1>
                    <p>Here you will learn some basic things you need to know to get started with mypyc.</p>
                    <section id="prerequisites">
                        <h2>Prerequisites<a class="headerlink" href="#prerequisites"
                                            title="Permalink to this heading">¶</a></h2>
                        <p>You need a Python C extension development environment. The way to set this up
                            depends on your operating system.</p>
                        <section id="macos">
                            <h3>macOS<a class="headerlink" href="#macos" title="Permalink to this heading">¶</a></h3>
                            <p>Install Xcode command line tools:</p>
                            <div class="highlight-default notranslate">
                                <div class="highlight"><pre><span></span>$ xcode-select --install
</pre>
                                </div>
                            </div>
                        </section>
                        <section id="linux">
                            <h3>Linux<a class="headerlink" href="#linux" title="Permalink to this heading">¶</a></h3>
                            <p>You need a C compiler and CPython headers and libraries. The specifics
                                of how to install these varies by distribution. Here are instructions for
                                Ubuntu 18.04, for example:</p>
                            <div class="highlight-default notranslate">
                                <div class="highlight"><pre><span></span>$ sudo apt install python3-dev
</pre>
                                </div>
                            </div>
                        </section>
                        <section id="windows">
                            <h3>Windows<a class="headerlink" href="#windows" title="Permalink to this heading">¶</a>
                            </h3>
                            <p>Install <a class="reference external"
                                          href="https://www.visualstudio.com/downloads/#build-tools-for-visual-studio-2017">Visual
                                C++</a>.</p>
                        </section>
                    </section>
                    <section id="installation">
                        <h2>Installation<a class="headerlink" href="#installation"
                                           title="Permalink to this heading">¶</a></h2>
                        <p>Mypyc is shipped as part of the mypy distribution. Install mypy like
                            this (you need Python 3.5 or later):</p>
                        <div class="highlight-default notranslate">
                            <div class="highlight"><pre><span></span>$ python3 -m pip install -U mypy
</pre>
                            </div>
                        </div>
                        <p>On some systems you need to use this instead:</p>
                        <div class="highlight-default notranslate">
                            <div class="highlight"><pre><span></span>$ python -m pip install -U mypy
</pre>
                            </div>
                        </div>
                    </section>
                    <section id="example-program">
                        <h2>Example program<a class="headerlink" href="#example-program"
                                              title="Permalink to this heading">¶</a></h2>
                        <p>Let’s start with a classic micro-benchmark, recursive fibonacci. Save
                            this file as <code class="docutils literal notranslate"><span
                                    class="pre">fib.py</span></code>:</p>
                        <div class="highlight-python notranslate">
                            <div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span
                                        class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span
                                        class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span
                                        class="p">:</span>
        <span class="k">return</span> <span class="n">n</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span> <span
                                        class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span
                                        class="o">+</span> <span class="n">fib</span><span class="p">(</span><span
                                        class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span
                                        class="p">)</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span
                                        class="p">()</span>
<span class="n">fib</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span
                                        class="p">()</span> <span class="o">-</span> <span class="n">t0</span><span
                                        class="p">)</span>
</pre>
                            </div>
                        </div>
                        <p>Note that we gave the <code class="docutils literal notranslate"><span class="pre">fib</span></code>
                            function a type annotation. Without it,
                            performance won’t be as impressive after compilation.</p>
                        <div class="admonition note">
                            <p class="admonition-title">Note</p>
                            <p><a class="reference external" href="https://mypy.readthedocs.io/en/stable/index.html">Mypy
                                documentation</a> is a good
                                introduction if you are new to type annotations or mypy. Mypyc uses
                                mypy to perform type checking and type inference, so some familiarity
                                with mypy is very useful.</p>
                        </div>
                    </section>
                    <section id="compiling-and-running">
                        <h2>Compiling and running<a class="headerlink" href="#compiling-and-running"
                                                    title="Permalink to this heading">¶</a></h2>
                        <p>We can run <code class="docutils literal notranslate"><span class="pre">fib.py</span></code>
                            as a regular, interpreted program using CPython:</p>
                        <div class="highlight-console notranslate">
                            <div class="highlight"><pre><span></span><span class="gp">$ </span>python3 fib.py
<span class="go">0.4125328063964844</span>
</pre>
                            </div>
                        </div>
                        <p>It took about 0.41s to run on my computer.</p>
                        <p>Run <code class="docutils literal notranslate"><span class="pre">mypyc</span></code> to
                            compile the program to a binary C extension:</p>
                        <div class="highlight-console notranslate">
                            <div class="highlight"><pre><span></span><span class="gp">$ </span>mypyc fib.py
</pre>
                            </div>
                        </div>
                        <p>This will generate a C extension for <code class="docutils literal notranslate"><span
                                class="pre">fib</span></code> in the current working
                            directory. For example, on a Linux system the generated file may be
                            called <code class="docutils literal notranslate"><span class="pre">fib.cpython-37m-x86_64-linux-gnu.so</span></code>.
                        </p>
                        <p>Since C extensions can’t be run as programs, use <code
                                class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">-c</span></code>
                            to run
                            the compiled module as a program:</p>
                        <div class="highlight-console notranslate">
                            <div class="highlight"><pre><span></span><span class="gp">$ </span>python3 -c <span
                                    class="s2">&quot;import fib&quot;</span>
<span class="go">0.04097270965576172</span>
</pre>
                            </div>
                        </div>
                        <p>After compilation, the program is about 10x faster. Nice!</p>
                        <div class="admonition note">
                            <p class="admonition-title">Note</p>
                            <p><code class="docutils literal notranslate"><span class="pre">__name__</span></code> in
                                <code class="docutils literal notranslate"><span class="pre">fib.py</span></code> would
                                now be <code class="docutils literal notranslate"><span
                                        class="pre">&quot;fib&quot;</span></code>, not <code
                                        class="docutils literal notranslate"><span
                                        class="pre">&quot;__main__&quot;</span></code>.</p>
                        </div>
                        <p>You can also pass most
                            <a class="reference external"
                               href="https://mypy.readthedocs.io/en/stable/command_line.html">mypy command line
                                options</a>
                            to <code class="docutils literal notranslate"><span class="pre">mypyc</span></code>.</p>
                    </section>
                    <section id="deleting-compiled-binary">
                        <h2>Deleting compiled binary<a class="headerlink" href="#deleting-compiled-binary"
                                                       title="Permalink to this heading">¶</a></h2>
                        <p>You can manually delete the C extension to get back to an interpreted
                            version (this example works on Linux):</p>
                        <div class="highlight-default notranslate">
                            <div class="highlight"><pre><span></span>$ rm fib.*.so
</pre>
                            </div>
                        </div>
                    </section>
                    <section id="using-setup-py">
                        <h2>Using setup.py<a class="headerlink" href="#using-setup-py"
                                             title="Permalink to this heading">¶</a></h2>
                        <p>You can also use <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>
                            to compile modules using mypyc. Here is an
                            example <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>
                            file:</p>
                        <div class="highlight-default notranslate">
                            <div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">setuptools</span> <span
                                    class="kn">import</span> <span class="n">setup</span>

<span class="kn">from</span> <span class="nn">mypyc.build</span> <span class="kn">import</span> <span
                                        class="n">mypycify</span>

<span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mylib&#39;</span><span class="p">,</span>
    <span class="n">packages</span><span class="o">=</span><span class="p">[</span><span
                                        class="s1">&#39;mylib&#39;</span><span class="p">],</span>
    <span class="n">ext_modules</span><span class="o">=</span><span class="n">mypycify</span><span class="p">([</span>
        <span class="s1">&#39;mylib/__init__.py&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mylib/mod.py&#39;</span><span class="p">,</span>
    <span class="p">]),</span>
<span class="p">)</span>
</pre>
                            </div>
                        </div>
                        <p>We used <code class="docutils literal notranslate"><span
                                class="pre">mypycify(...)</span></code> to specify which files to compile using
                            mypyc. Your <code class="docutils literal notranslate"><span
                                    class="pre">setup.py</span></code> can include additional Python files outside
                            <code class="docutils literal notranslate"><span class="pre">mypycify(...)</span></code>
                            that won’t be compiled.</p>
                        <p>Now you can build a wheel (.whl) file for the package:</p>
                        <div class="highlight-default notranslate">
                            <div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">setup</span><span
                                    class="o">.</span><span class="n">py</span> <span class="n">bdist_wheel</span>
</pre>
                            </div>
                        </div>
                        <p>The wheel is created under <code class="docutils literal notranslate"><span
                                class="pre">dist/</span></code>.</p>
                        <p>You can also compile the C extensions in-place, in the current directory (similar
                            to using <code class="docutils literal notranslate"><span class="pre">mypyc</span></code> to
                            compile modules):</p>
                        <div class="highlight-default notranslate">
                            <div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">setup</span><span
                                    class="o">.</span><span class="n">py</span> <span class="n">build_ext</span> <span
                                    class="o">--</span><span class="n">inplace</span>
</pre>
                            </div>
                        </div>
                        <p>You can include most <a class="reference external"
                                                   href="https://mypy.readthedocs.io/en/stable/command_line.html">mypy
                            command line options</a> in the
                            list of arguments passed to <code class="docutils literal notranslate"><span class="pre">mypycify()</span></code>.
                            For example, here we use
                            the <code class="docutils literal notranslate"><span
                                    class="pre">--disallow-untyped-defs</span></code> flag to require that all functions
                            have type annotations:</p>
                        <div class="highlight-default notranslate">
                            <div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;frobnicate&#39;</span><span
                                        class="p">,</span>
    <span class="n">packages</span><span class="o">=</span><span class="p">[</span><span
                                        class="s1">&#39;frobnicate&#39;</span><span class="p">],</span>
    <span class="n">ext_modules</span><span class="o">=</span><span class="n">mypycify</span><span class="p">([</span>
        <span class="s1">&#39;--disallow-untyped-defs&#39;</span><span class="p">,</span>  <span class="c1"># Pass a mypy flag</span>
        <span class="s1">&#39;frobnicate.py&#39;</span><span class="p">,</span>
    <span class="p">]),</span>
<span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </section>
                    <section id="recommended-workflow">
                        <h2>Recommended workflow<a class="headerlink" href="#recommended-workflow"
                                                   title="Permalink to this heading">¶</a></h2>
                        <p>A simple way to use mypyc is to always compile your code after any
                            code changes, but this can get tedious, especially if you have a lot
                            of code. Instead, you can do most development in interpreted mode.
                            This development workflow has worked smoothly for developing mypy and
                            mypyc (often we forget that we aren’t working on a vanilla Python
                            project):</p>
                        <ol class="arabic simple">
                            <li><p>During development, use interpreted mode. This gives you a fast
                                edit-run cycle.</p></li>
                            <li><p>Use type annotations liberally and use mypy to type check your code
                                during development. Mypy and tests can find most errors that would
                                break your compiled code, if you have good type annotation
                                coverage. (Running mypy is pretty quick.)</p></li>
                            <li><p>After you’ve implemented a feature or a fix, compile your project
                                and run tests again, now in compiled mode. Usually nothing will
                                break here, assuming your type annotation coverage is good. This
                                can happen locally or in a Continuous Integration (CI) job. If you
                                have CI, compiling locally may be rarely needed.</p></li>
                            <li><p>Release or deploy a compiled version. Optionally, include a
                                fallback interpreted version for platforms that mypyc doesn’t
                                support.</p></li>
                        </ol>
                        <p>This mypyc workflow only involves minor tweaks to a typical Python
                            workflow. Most of development, testing and debugging happens in
                            interpreted mode. Incremental mypy runs, especially when using the
                            mypy daemon, are very quick (often a few hundred milliseconds).</p>
                    </section>
                    <section id="next-steps">
                        <h2>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this heading">¶</a>
                        </h2>
                        <p>You can sometimes get good results by just annotating your code and
                            compiling it. If this isn’t providing meaningful performance gains, if
                            you have trouble getting your code to work under mypyc, or if you want
                            to optimize your code for maximum performance, you should read the
                            rest of the documentation in some detail.</p>
                        <p>Here are some specific recommendations, or you can just read the
                            documentation in order:</p>
                        <ul class="simple">
                            <li><p><a class="reference internal"
                                      href="using_type_annotations.html#using-type-annotations"><span
                                    class="std std-ref">Using type annotations</span></a></p></li>
                            <li><p><a class="reference internal" href="native_classes.html#native-classes"><span
                                    class="std std-ref">Native classes</span></a></p></li>
                            <li><p><a class="reference internal"
                                      href="differences_from_python.html#differences-from-python"><span
                                    class="std std-ref">Differences from Python</span></a></p></li>
                            <li><p><a class="reference internal"
                                      href="performance_tips_and_tricks.html#performance-tips"><span
                                    class="std std-ref">Performance tips and tricks</span></a></p></li>
                        </ul>
                    </section>
                </section>


            </div>

        </div>
    </div>
    <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h1 class="logo"><a href="../../../../../index.html">Atbash</a></h1>


            <h3>Navigation</h3>

            <div class="relations">
                <h3>Related Topics</h3>
                <ul>
                    <li><a href="../../../../../index.html">Documentation overview</a>
                        <ul>
                        </ul>
                    </li>
                </ul>
            </div>
            <div id="searchbox" style="display: none" role="search">
                <h3 id="searchlabel">Quick search</h3>
                <div class="searchformwrapper">
                    <form class="search" action="../../../../../search.html" method="get">
                        <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off"
                               autocapitalize="off" spellcheck="false"/>
                        <input type="submit" value="Go"/>
                    </form>
                </div>
            </div>
            <script>document.getElementById('searchbox').style.display = "block"</script>


        </div>
    </div>
    <div class="clearer"></div>
</div>
<div class="footer">
    &copy;2022, Leor Fishman, Ben Simon, Kent Worcester, Prince Fefar.

    |
    Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
    &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>

    |
    <a href="../../../../../_sources/venv/Lib/site-packages/mypyc/doc/getting_started.rst.txt"
       rel="nofollow">Page source</a>
</div>


</body>
</html>